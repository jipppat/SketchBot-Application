import 'package:roslibdart/roslibdart.dart';

class RosService {
  late Ros ros;
  Topic? pub;

  void connect() {
    ros = Ros(url: 'ws://172.20.10.4:9090');

    ros.connect();
    print("üöÄ Trying to connect...");

    // init topic ‡∏´‡∏•‡∏±‡∏á connect (roslibdart ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ Future)
    pub = Topic(
      ros: ros,
      name: '/arm_target_pose',
      type: 'geometry_msgs/PoseStamped',
    );
  }

  void sendPose() {
    if (pub == null) {
      print("‚ö†Ô∏è Cannot publish: Topic not initialized.");
      return;
    }

    final msg = {
      "header": {"frame_id": "base_link"},
      "pose": {
        "position": {"x": 0.3, "y": 0.0, "z": 0.2},
        "orientation": {"x": 0.0, "y": 0.0, "z": 0.0, "w": 1.0},
      }
    };
    pub!.publish(msg);
    print("üì§ Pose sent!");
  }
}